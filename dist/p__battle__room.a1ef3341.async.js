"use strict";(self.webpackChunkmucsgo=self.webpackChunkmucsgo||[]).push([[378],{68927:function(K,L,t){t.d(L,{B:function(){return f}});var D=t(36683),f=(0,D.Z)({scriptUrl:["//at.alicdn.com/t/c/font_4204248_ne0cw2rytxj.js"]})},34793:function(K,L,t){t.d(L,{Z:function(){return n}});var D=t(97857),f=t.n(D),Y=t(19632),R=t.n(Y),N=t(5574),o=t.n(N),Z=t(19515),O=t(15168),w=t(52830),g=t(67294),d=t(85893),e=function(p){var X=p.giftList,T=p.lotteryWin,W=p.onCompleted,A=p.vertical,ee=A===void 0?!1:A,we=p.randomPosition,Se=we===void 0?!0:we,h=p.boxSize,Ee=p.wrapHeight,We=Ee===void 0?200:Ee,Re=p.start,Be=p.fast,xe=Be===void 0?!1:Be,j=p.voice,oe=j===void 0?!0:j,Oe=p.lotteryIndex,Me=Oe===void 0?0:Oe,$e=40,ie=30,Ge=xe?100*ie:250*ie,ze=(0,g.useState)([]),De=o()(ze,2),Ue=De[0],Ze=De[1],ue=(0,g.useRef)(0),Le=(0,g.useRef)(null),I=(0,w.q_)(function(){return{from:ee?{y:0}:{x:0}}}),y=o()(I,2),x=y[0],b=y[1],U=(0,w.q_)(function(){return{from:{scale:1}}}),C=o()(U,2),B=C[0],te=C[1],k=(0,w.q_)(function(){return{from:{rotate:0}}}),J=o()(k,2),de=J[0],fe=J[1],Je=(0,w.q_)(function(){return{from:{opacity:1}}}),pe=o()(Je,2),Ie=pe[0],ce=pe[1],He=function(){b.start({from:ee?{y:0}:{x:0}}),te.start({from:{scale:1}}),fe.start({from:{rotate:0}}),ce.start({from:{opacity:1}})},he=function(){fe.start({from:{rotate:0},to:{rotate:360},config:{duration:500}}),ce.start({from:{opacity:1},to:{opacity:.3},config:{duration:500}}),te.start({from:{scale:1},to:{scale:1.3},config:{duration:500},onResolve:function(){W(Me)}})},Ke=function(){var S=R()(X);if(S.length<$e)for(var E=0;E<$e;E++){var G=Math.floor(Math.random()*X.length);S.push(X[G])}S.sort(function(){return Math.random()-.5}),S.splice(ie,0,T),Ze(S)},ge=function(){var S=h.height,E;Se?E=Math.random()*(S-30)+30:E=S/2;var G=ie*S-We/2+E;b.start({from:{y:0},to:{y:-G},config:{duration:Ge,easing:w.Z5.easeOutQuint},onChange:function(je){var ne=je.value.y,be=ne-ue.current,re=Math.abs(be);re>S&&(ue.current=ne,oe&&(0,O.p)())},onResolve:function(){he()}})},Ye=function(){var S,E=h.width,G;Se?G=Math.random()*(E-30)+30:G=E/2;var se=((S=Le.current)===null||S===void 0?void 0:S.offsetWidth)||0,je=ie*E-se/2+G;b.start({from:{x:0},to:{x:-je},config:{duration:Ge,easing:w.Z5.easeOutQuint},onChange:function(be){var re=be.value.x,Ve=re-ue.current,ye=Math.abs(Ve);ye>E&&(ue.current=re,oe&&(0,O.p)())},onResolve:function(){he()}})};return(0,g.useEffect)(function(){!X&&!T||(He(),Ke())},[X,T]),(0,g.useEffect)(function(){Re&&(0,Z._v)(500*Me).then(function(){ee?ge():Ye()})},[Re]),(0,d.jsx)("div",{className:"w-full overflow-hidden relative",style:{height:We},ref:Le,children:(0,d.jsx)(w.q.div,{style:f()({},x),className:"flex items-center w-full h-full ".concat(ee?"flex-col":"flex-row"),children:Ue.map(function($,S){var E,G=$.id===T.id,se=(E=$.grade)!==null&&E!==void 0?E:$.giftGrade;return(0,d.jsxs)("div",{className:"lottery-card",style:{width:h.width,height:h.height},children:[(0,d.jsx)(w.q.img,{style:f()({},G?B:Ie),src:$.giftImage,className:"sm:w-full sm:h-full z-10 will-change-transform"}),(0,d.jsx)(w.q.div,{style:f()({},G?de:Ie),className:"lottery-card-bg lottery-card-".concat(se)})]},S)})})})},n=e},9567:function(K,L,t){var D=t(19515),f=t(68927),Y=t(7988),R=t(67294),N=t(50549),o=t(85893);L.Z=R.memo(function(O){var w,g,d,e=O.loading,n=O.data,V=O.mini,p=V===void 0?!1:V;if(e){var X=Math.floor(Math.random()*4);return(0,o.jsx)("div",{className:"weapon-card weapon-card-grade-".concat(X," "),children:(0,o.jsx)("div",{className:"flex w-full h-full justify-center items-center",children:(0,o.jsx)(N.Z,{width:70,height:30,baseColor:"rgba(0, 0, 0, 0.15)",highlightColor:"rgba(0, 0, 0, 0.2)"})})})}var T=(n==null?void 0:n.giftName)||(n==null?void 0:n.voucherName)||(n==null?void 0:n.winVoucherName),W=(n==null?void 0:n.recoveryPrice)||(n==null?void 0:n.giftPrice)||(n==null?void 0:n.winRecoveryPrice),A=(n==null?void 0:n.giftImage)||(n==null?void 0:n.winVoucherImg),ee=(w=n==null?void 0:n.grade)!==null&&w!==void 0?w:n==null?void 0:n.giftGrade;return(0,o.jsxs)("div",{className:"weapon-card weapon-card-grade-".concat(ee),children:[(0,o.jsx)("div",{className:"img-wrapper",children:(0,o.jsx)("img",{src:A})}),(0,o.jsxs)("div",{className:"item-footer flex flex-col gap-1",children:[(0,o.jsx)("div",{className:"text-xs truncate",children:T&&((g=(0,D.Jq)(T))===null||g===void 0?void 0:g[0])}),p?(0,o.jsxs)("div",{className:"text-xs flex justify-center",children:[(0,o.jsx)(f.B,{type:"icon-daimond",className:"mr-1"}),(0,o.jsx)("span",{className:"font-num",children:W&&(0,D.Y6)(Number(W))})]}):(0,o.jsxs)("div",{className:"text-xs flex justify-between",children:[(0,o.jsx)("span",{className:"text-base-content text-opacity-50 truncate",children:T&&((d=(0,D.Jq)(T))===null||d===void 0?void 0:d[1])}),(0,o.jsxs)("span",{className:"flex",children:[(0,o.jsx)(f.B,{type:"icon-daimond",className:"mr-1 "}),(0,o.jsx)("span",{className:"font-num",children:W&&(0,D.Y6)(Number(W))})]})]})]}),(0,o.jsxs)("div",{className:"item-prop flex flex-col gap-1 text-xs text-base-content text-opacity-50 text-right",children:[(n==null?void 0:n.rollCodeHigh)&&(n==null?void 0:n.rollCodeLow)&&(0,o.jsxs)("div",{className:"flex gap-1",children:[(0,o.jsx)(f.B,{type:"icon-rollpoint"}),n.rollCodeLow,"-",n.rollCodeHigh]}),(n==null?void 0:n.realProbability)&&(0,o.jsxs)("div",{children:[(0,D.Y6)(n.realProbability*100),"%"]})]})]})})},92502:function(K,L,t){t.d(L,{Z:function(){return o}});var D=t(9567),f=t(19515),Y=t(7363),R=t(11983),N=t(85893);function o(Z){var O,w,g=Z.boxInfo,d=Z.show,e=Z.onClose;return(0,N.jsxs)(R.u_,{open:d,className:"max-w-6xl",children:[(0,N.jsxs)(R.u_.Header,{className:"mb-2 text-center text-lg",children:[g==null?void 0:g.boxName," ",(0,N.jsx)(Y.FormattedMessage,{id:"include_gifts"}),"\uFF1A"]}),(0,N.jsx)(R.zx,{size:"xs",shape:"circle",color:"ghost",className:"absolute right-2 top-2",onClick:e,children:"\u2715"}),(0,N.jsxs)(R.u_.Body,{className:"overflow-y-scroll max-h-[600px] sm:overflow-y-auto sm:max-h-full",children:[(g==null?void 0:g.gradeGiftProb)&&(0,N.jsxs)("div",{className:"flex items-center justify-center gap-2 flex-wrap mb-4 font-num",children:[(0,N.jsx)("span",{className:"text-sm uppercase font-semibold",children:(0,N.jsx)(Y.FormattedMessage,{id:"drop_probability"})}),g==null||(O=g.gradeGiftProb)===null||O===void 0?void 0:O.map(function(n,V){var p=(0,f.jx)(n.grade||0);return(0,N.jsxs)("div",{className:"flex items-center gap-2",children:[(0,N.jsx)("div",{className:"w-6 h-2 rounded-full",style:{backgroundColor:p}}),(0,N.jsxs)("div",{className:"text-white text-sm text-[".concat(p,"]"),children:[(n==null?void 0:n.prob)&&(0,f.Y6)((n==null?void 0:n.prob)*100),"%"]})]},V)})]}),(0,N.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:g==null||(w=g.boxGiftVo)===null||w===void 0?void 0:w.map(function(n,V){return(0,N.jsx)(D.Z,{data:n},V)})})]})]})}},7932:function(K,L,t){t.r(L),t.d(L,{default:function(){return Le}});var D=t(15009),f=t.n(D),Y=t(99289),R=t.n(Y),N=t(5574),o=t.n(N),Z=t.p+"static/fighting.d98ec4b9.png",O=t.p+"static/num1.fb996743.png",w=t.p+"static/num2.0734f4f0.png",g=t.p+"static/num3.65a4905f.png",d=t(67294),e=t(85893),n=function(y){var x=y.onFinish,b=(0,d.useState)(4),U=o()(b,2),C=U[0],B=U[1];return(0,d.useEffect)(function(){var te=setInterval(function(){B(function(k){return k-1})},1e3);return C===0&&(clearInterval(te),x()),function(){return clearInterval(te)}},[C]),(0,e.jsxs)("div",{className:"fixed top-0 left-0 w-full h-full flex items-center justify-center z-[999] bg-black bg-opacity-30",children:[C===3&&(0,e.jsx)("img",{src:g,className:"animate__animated animate__zoomIn w-[108px] h-[108px] sm:w-[160px] sm:h-[160px]"}),C===2&&(0,e.jsx)("img",{src:w,className:"animate__animated animate__zoomIn w-[108px] h-[108px] sm:w-[160px] sm:h-[160px]"}),C===1&&(0,e.jsx)("img",{src:O,className:"animate__animated animate__zoomIn w-[108px] h-[108px] sm:w-[160px] sm:h-[160px]"}),C===0&&(0,e.jsx)("img",{src:Z,className:"animate__animated animate__rotateIn w-[270px] h-[40px] sm:w-[405px] sm:h-[60px]"})]})},V=n,p=t(68927),X=t(34793),T=t(9567),W=t(33148),A=t(19515),ee=t(89739),we=t(6171),Se=t(92443),h=t(7363),Ee=t(17909),We=t(42965),Re=t(50361),Be=t.n(Re),xe=t(17857),j=t(11983),oe=t(22920),Oe=t(73350),Me=t(5031),$e=t(35828),ie=t(92502),Ge=t(22372);function ze(I){var y=I.show,x=I.onClose,b=I.data,U=b.info,C=b.boxOpenRecords;return(0,e.jsxs)(j.u_,{open:y,className:"max-w-4xl",children:[(0,e.jsx)(j.u_.Header,{className:"mb-2 text-center",children:"\u516C\u5E73\u6027\u9A8C\u8BC1"}),(0,e.jsx)(j.zx,{size:"xs",shape:"circle",color:"ghost",className:"absolute right-2 top-2",onClick:x,children:"\u2715"}),(0,e.jsx)(j.u_.Body,{className:"max-h-[calc(100vh-64px)] overflow-y-scroll sm:overflow-y-auto",children:C==null?void 0:C.map(function(B,te){var k;return(0,e.jsxs)("div",{className:"w-full",children:[(0,e.jsxs)("div",{className:"flex w-full gap-2 items-center px-3 py-3",children:[(0,e.jsx)("img",{src:B==null?void 0:B.headPic,className:"w-8 h-8 rounded"}),(0,e.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,e.jsxs)("span",{children:[B.nickname," "]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("span",{children:"\u7ED3\u679C\uFF1A"}),B.winner?(0,e.jsx)("span",{className:"text-success",children:"\u80DC\u5229"}):(0,e.jsx)("span",{className:"text-error",children:"\u5931\u8D25"})]})]})]}),(0,e.jsx)("div",{className:"flex gap-2 overflow-x-auto p-3 bg-neutral-900 rounded-md",children:B==null||(k=B.userOpenBoxRecord)===null||k===void 0?void 0:k.map(function(J,de){return(0,e.jsxs)("div",{className:"flex flex-col items-center flex-shrink-0 w-40 gap-1",children:[(0,e.jsxs)("div",{className:"mb-2 mt-1 text-center text-xs font-bold uppercase",children:["ROUND ",J.round]}),(0,e.jsx)(T.Z,{data:J},de),(0,e.jsxs)("div",{className:"mt-2 flex gap-1 text-xs font-bold uppercase",children:[(0,e.jsxs)("span",{children:["Roll ID ",J.rollCode]}),(0,e.jsx)(h.Link,{to:"/user/provably-fair/verify/".concat(J.verifyId),children:(0,e.jsx)(p.B,{type:"icon-shield",className:"text-success"})})]})]},de)})})]})})})]})}var De=function(y){if(!y)return(0,A.Y6)(0,2);var x=0;return y.forEach(function(b){x+=b.giftPrice}),(0,A.Y6)(x,2)},Ue=function(y){var x=y.user,b=y.onJoin,U=y.onJoinBot,C=y.isOwner;return(0,e.jsx)("div",{children:x!=null&&x.customerId?(0,e.jsxs)("div",{className:"flex flex-col gap-4 items-center",children:[(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(ee.Z,{className:"text-success text-[32px]"}),(0,e.jsx)("div",{className:"animate-circleChange absolute w-8 h-8 rounded-full left-0 top-0 border-2 border-success"})]}),(0,e.jsx)("span",{className:"font-num",children:"Ready"})]}):(0,e.jsxs)("div",{className:"flex flex-col gap-4 items-center",children:[(0,e.jsx)(p.B,{type:"icon-zhandou",className:"text-primary text-[28px] animate-bounce"}),C?(0,e.jsx)("div",{className:"rounded px-2 py-1 text-xs border border-primary text-primary cursor-pointer",onClick:U,children:(0,e.jsx)(h.FormattedMessage,{id:"battle_room_join_bot"})}):(0,e.jsx)("div",{className:"rounded px-2 py-1 text-xs border border-primary text-primary cursor-pointer",onClick:b,children:(0,e.jsx)(h.FormattedMessage,{id:"battle_room_join"})})]})})},Ze=function(y){var x=y.result;return(0,e.jsx)("div",{className:"flex flex-col animate__animated animate__zoomIn items-center",children:x!=null&&x.winner?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"font-num win-text text-[21px] sm:text-[42px]",children:"WIN"}),(0,e.jsxs)("div",{className:"flex gap-1 items-center font-num text-[#D2C87B] text-xs sm:text-base",children:[(0,e.jsx)(p.B,{type:"icon-daimond"}),(0,e.jsx)(xe.ZP,{end:(x==null?void 0:x.totalPrice)||0,duration:1,decimals:2,separator:""})]})]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"font-num lose-text text-[21px] sm:text-[42px]",children:"LOSE"}),(0,e.jsxs)("div",{className:"flex gap-1 items-center font-num text-xs sm:text-base",children:[(0,e.jsx)(p.B,{type:"icon-daimond"}),(0,e.jsx)(xe.ZP,{end:(x==null?void 0:x.totalPrice)||0,duration:1,decimals:2,separator:""})]})]})})},ue=function(y){var x=y.boxs,b=y.cols,U=y.mini,C="grid-cols-4";return b===2?C="sm:grid-cols-4":b===3?C="sm:grid-cols-3":b===4&&(C="sm:grid-cols-2"),(0,e.jsx)(Oe.Z,{className:"flex flex-col-reverse sm:grid gap-1 sm:gap-2 ".concat(C," items-center mt-2 sm:mt-4 w-full"),children:x==null?void 0:x.map(function(B){return(0,e.jsx)(Me.Z,{classNames:{enter:"animate-item-enter",enterActive:"animate-item-enter-active",enterDone:"animate-item-enter-done",exit:"animate-item-exit",exitActive:"animate-item-exit-active",exitDone:"animate-item-exit-done"},timeout:500,children:(0,e.jsx)(T.Z,{data:B,mini:U})},B.id)})})};function Le(){var I,y,x=(0,d.useRef)(null),b=(I=(0,h.useParams)())===null||I===void 0?void 0:I.id,U=(0,d.useState)(),C=o()(U,2),B=C[0],te=C[1],k=(0,d.useState)(!1),J=o()(k,2),de=J[0],fe=J[1],Je=(0,d.useState)(!1),pe=o()(Je,2),Ie=pe[0],ce=pe[1],He=(0,d.useState)(!1),he=o()(He,2),Ke=he[0],ge=he[1],Ye=(0,d.useState)(0),$=o()(Ye,2),S=$[0],E=$[1],G=(0,d.useState)(!1),se=o()(G,2),je=se[0],ne=se[1],be=(0,d.useState)(!1),re=o()(be,2),Ve=re[0],ye=re[1],wt=(0,d.useState)(!1),et=o()(wt,2),St=et[0],tt=et[1],Et=(0,d.useState)(1),st=o()(Et,2),ve=st[0],Rt=st[1],Bt=(0,d.useState)(),nt=o()(Bt,2),P=nt[0],Ae=nt[1],Ot=(0,d.useState)(!1),at=o()(Ot,2),Mt=at[0],Pe=at[1],Dt=(0,d.useState)(!1),ot=o()(Dt,2),Lt=ot[0],Fe=ot[1],It=(0,d.useState)(!1),it=o()(It,2),me=it[0],Xe=it[1],At=(0,d.useState)(!1),rt=o()(At,2),lt=rt[0],ut=rt[1],Pt=(0,d.useState)(!1),dt=o()(Pt,2),ct=dt[0],vt=dt[1],Ft=(0,d.useState)(!1),mt=o()(Ft,2),xt=mt[0],ft=mt[1],pt=(0,h.useModel)("user"),ke=pt.getUser,Q=pt.userInfo,ht=(0,h.useModel)("sys"),Qe=ht.voice,_t=ht.toggleVoice,Tt=(0,d.useState)(!1),gt=o()(Tt,2),Wt=gt[0],$t=gt[1],_e=(0,Ee.F)(),Gt=(0,h.useModel)("socket"),le=Gt.battleState,zt=function(r,i){if(!P||!i||(P==null?void 0:P.length)===0)return null;if(r===0||r===3){var l=0,m=[];return P==null||P.forEach(function(a){var F;if(a.customerId){var M=0;a==null||(F=a.userOpenBoxRecord)===null||F===void 0||F.forEach(function(H){M+=H.giftPrice||0}),M>l?(l=M,m=[a.customerId]):M===l&&m.push(a.customerId)}}),m.includes(i)}else{var v,q=[];return P==null||P.forEach(function(a){var F,M=0;a.customerId&&(a==null||(F=a.userOpenBoxRecord)===null||F===void 0||F.forEach(function(H){M+=H.giftPrice||0}),v===void 0?(v=M,q.push(a.customerId)):M<v?(v=M,q=[a.customerId]):M===v&&q.push(a.customerId))}),q.includes(i)}},Ut=function(r,i,l){te({boxName:r,boxGiftVo:i,gradeGiftProb:l}),fe(!0)},jt=(0,h.useRequest)(function(){return b&&(0,W.Td)({battleCode:b})},{refreshDeps:[b]}),s=jt.data,Zt=jt.refresh;(0,d.useEffect)(function(){if((le==null?void 0:le.battleCode)===b){if((le==null?void 0:le.state)===2)return;Zt()}},[le]);var Jt=(0,h.useRequest)(R()(f()().mark(function u(){return f()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!((s==null?void 0:s.state)===1||(s==null?void 0:s.state)===2)){i.next=4;break}return i.next=3,(0,W.fQ)({battleCode:b||""});case 3:return i.abrupt("return",i.sent);case 4:case"end":return i.stop()}},u)})),{refreshDeps:[s==null?void 0:s.state]}),c=Jt.data,Ht=function(){var u=R()(f()().mark(function r(i){var l;return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!lt){v.next=2;break}return v.abrupt("return");case 2:return ut(!0),v.next=5,(0,W.GI)({battleCode:b||"",pos:i});case 5:l=v.sent,ut(!1),ce(!1),l.status===0&&(oe.Am.success((0,e.jsx)(h.FormattedMessage,{id:"roll_detail_jrcg"})),ke());case 9:case"end":return v.stop()}},r)}));return function(i){return u.apply(this,arguments)}}(),Kt=function(){var u=R()(f()().mark(function r(i){var l;return f()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!ct){v.next=2;break}return v.abrupt("return");case 2:return vt(!0),v.next=5,(0,W.BR)({battleCode:b||"",pos:i});case 5:l=v.sent,vt(!1),ge(!1),l.status===0&&oe.Am.success((0,e.jsx)(h.FormattedMessage,{id:"roll_detail_jrcg"}));case 9:case"end":return v.stop()}},r)}));return function(i){return u.apply(this,arguments)}}(),Yt=function(){var u=R()(f()().mark(function r(){var i;return f()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!xt){m.next=2;break}return m.abrupt("return");case 2:return ft(!0),m.next=5,(0,W.hH)({battleCode:b||""});case 5:i=m.sent,ft(!1),ne(!1),i.status===0&&(oe.Am.success("\u89E3\u6563\u6210\u529F"),ke(),h.history.replace("/battle"));case 9:case"end":return m.stop()}},r)}));return function(){return u.apply(this,arguments)}}(),Te=function(r){var i,l;Rt(r);var m=(i=x.current)===null||i===void 0?void 0:i.children;m==null||(l=m[r])===null||l===void 0||l.scrollIntoView({behavior:"smooth",block:"nearest"})},bt=function(r){if(c!=null&&c.boxOpenRecords){var i=Be()(c==null?void 0:c.boxOpenRecords);i==null||i.map(function(l){var m;return l.userOpenBoxRecord=l==null||(m=l.userOpenBoxRecord)===null||m===void 0?void 0:m.slice(0,r),l}),Ae(i)}},Vt=function(){var u=R()(f()().mark(function r(){return f()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,A._v)(1500);case 2:return ye(!1),l.next=5,(0,A._v)(500);case 5:Te(1),Pe(!0);case 7:case"end":return l.stop()}},r)}));return function(){return u.apply(this,arguments)}}(),Xt=function(){var u=R()(f()().mark(function r(){var i,l,m,v;return f()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(bt(ve),Pe(!1),!(s!=null&&s.boxList&&ve===(s==null||(i=s.boxList)===null||i===void 0?void 0:i.length))){a.next=10;break}return a.next=5,(0,A._v)(2500);case 5:Fe(!1),Xe(!0),Qe&&Wt&&(m=!1,v=c==null||(l=c.customerGainList)===null||l===void 0?void 0:l.find(function(F){return F.customerId===(Q==null?void 0:Q.id)}),ke()),a.next=16;break;case 10:return a.next=12,(0,A._v)(1500);case 12:return Te(ve+1),a.next=15,(0,A._v)(1e3);case 15:Pe(!0);case 16:case"end":return a.stop()}},r)}));return function(){return u.apply(this,arguments)}}();(0,d.useEffect)(function(){var u;if((s==null?void 0:s.state)===3&&(oe.Am.error("\u8BE5\u623F\u95F4\u5DF2\u88AB\u89E3\u6563"),h.history.replace("/battle")),s!=null&&s.customerList){var r,i=(s==null||(r=s.customerList)===null||r===void 0?void 0:r.findIndex(function(q){return q.customerId===(Q==null?void 0:Q.id)}))>-1;$t(i)}if(c&&(s==null?void 0:s.state)===2){var l;Te((s==null||(l=s.boxList)===null||l===void 0?void 0:l.length)||0),Xe(!0)}if((s==null?void 0:s.state)===1&&c!==null&&c!==void 0&&(u=c.info)!==null&&u!==void 0&&u.round){var m,v=c==null||(m=c.info)===null||m===void 0?void 0:m.round;if(v<1)return;v===1?(Fe(!0),ye(!0)):(bt(v-1),Te(v),Fe(!0),Pe(!0))}},[c,s==null?void 0:s.state]),(0,d.useEffect)(function(){if(me&&c!==null&&c!==void 0&&c.customerGainList)if(_e.md)Ae(c==null?void 0:c.customerGainList);else{var u=c==null?void 0:c.customerGainList.map(function(r){var i;return r.userOpenBoxRecord=r==null||(i=r.userOpenBoxRecord)===null||i===void 0?void 0:i.reverse(),r});Ae(u)}},[me]);var Ne=s||{},yt=Ne.countCustomer,qe=yt===void 0?2:yt,ae=Ne.customerList,kt=Ne.state,z=Ne.boxList,Nt=Ne.mode,Ct=(s==null?void 0:s.customerId)===(Q==null?void 0:Q.id),Qt=function(){Ae([]),Xe(!1),ye(!0),Fe(!0)};return(0,e.jsxs)("div",{className:"max-w-[1400px] w-full m-auto mt-4",children:[Ve&&(0,e.jsx)(V,{onFinish:Vt}),(0,e.jsxs)("div",{className:"battle-title h-[38px] sm:h-[76px]",children:[(0,e.jsxs)(h.Link,{className:"btn btn-xs sm:btn-sm btn-neutral absolute left-2 top-[50%] -mt-[12px] sm:-mt-[16px] rounded",to:"/battle",children:[(0,e.jsx)(we.Z,{}),(0,e.jsx)(h.FormattedMessage,{id:"common_back"})]}),(0,e.jsx)("div",{className:"text-2xl sm:text-3xl",children:Nt!==void 0&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:"".concat((0,A.co)(Nt))}),(0,e.jsx)("span",{className:"font-num",children:"BATTLE"})]})})]}),s&&(0,e.jsxs)("div",{className:"px-3 sm:px-0",children:[(0,e.jsxs)("div",{className:"flex justify-between my-3 sm:my-5",children:[(0,e.jsxs)("div",{className:"flex items-center text-sm sm:text-base gap-2 font-num",children:[(0,e.jsx)("span",{className:"uppercase",children:"Total"}),(0,e.jsxs)("span",{className:"mx-1",children:[(0,e.jsx)(p.B,{type:"icon-coin",className:"mr-1"}),s==null?void 0:s.totalPrice]})]}),(0,e.jsxs)("div",{className:"flex gap-3 items-center",children:[c&&s.state===2&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ze,{show:St,onClose:function(){return tt(!1)},data:c}),(0,e.jsx)("div",{className:"cursor-pointer",onClick:function(){return tt(!0)},children:(0,e.jsx)(p.B,{type:"icon-shield",className:"text-success"})}),(0,e.jsx)(p.B,{type:"icon-luxiang",onClick:Qt})]}),Ct&&ae&&(ae==null?void 0:ae.length)<2&&(0,e.jsx)(Se.Z,{onClick:function(){return ne(!0)}}),(0,e.jsx)(j.HY,{onElement:(0,e.jsx)(p.B,{type:"icon-shengyin"}),offElement:(0,e.jsx)(p.B,{type:"icon-shengyinguanbi"}),active:Qe,onClick:_t})]})]}),(0,e.jsxs)("div",{className:"bg-neutral rounded sm:rounded-md py-5 flex px-5 sm:px-8 items-center gap-5",children:[(0,e.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,e.jsxs)("div",{className:"w-[78px] h-[78px] sm:w-[120px] sm:h-[120px] flex items-center justify-center relative",children:[(0,e.jsx)("div",{className:"round-bg animate-spin-slow"}),(0,e.jsx)("span",{className:"font-num text-[#A5DCFF] text-xl sm:text-4xl",children:z==null?void 0:z.length})]}),(0,e.jsxs)("div",{className:"font-num sm:text-xl text-base-content text-opacity-60",children:[ve,"/",z==null?void 0:z.length]})]}),(0,e.jsx)("div",{className:"flex-1 overflow-x-auto hide-scrollbar",children:(0,e.jsx)("div",{className:"flex gap-2 flex-nowrap",ref:x,children:z==null?void 0:z.map(function(u,r){var i=r+1===ve;return(0,e.jsx)("div",{className:"w-16 h-16 flex-shrink-0 sm:w-24 sm:h-24 flex justify-center items-center cursor-pointer transform will-change-transform transition duration-300 ".concat(i&&!me?"scale-[1.2]":me?"opacity-100":"opacity-50"),onClick:function(){return Ut(u.boxName,u.giftList,u.gradeGiftProb)},children:(0,e.jsx)("img",{src:u.boxImage,className:"w-full h-full"})},r)})})})]})]}),s&&(0,e.jsx)("div",{className:"mt-4 p-3 bg-base-100",children:(0,e.jsx)("div",{className:"grid grid-cols-".concat(qe," gap-2 sm:gap-3 w-full"),children:Array.from({length:qe}).map(function(u,r){var i,l,m,v,q=r===qe-1,a=ae==null?void 0:ae.filter(function(_){return Number(_==null?void 0:_.pos)===r+1})[0],F=c==null||(i=c.boxOpenRecords)===null||i===void 0?void 0:i.filter(function(_){return _.customerId===(a==null?void 0:a.customerId)})[0],M=c==null||(l=c.customerGainList)===null||l===void 0?void 0:l.filter(function(_){return _.customerId===(a==null?void 0:a.customerId)})[0],H=P==null?void 0:P.filter(function(_){return _.customerId===(a==null?void 0:a.customerId)})[0],qt=me?M==null?void 0:M.winner:zt(s==null?void 0:s.mode,a==null?void 0:a.customerId),es=De(H==null?void 0:H.userOpenBoxRecord),Ce=F==null||(m=F.userOpenBoxRecord)===null||m===void 0?void 0:m[ve-1],ts=z==null||(v=z.filter(function(_){return _.boxId===(Ce==null?void 0:Ce.boxId)})[0])===null||v===void 0?void 0:v.giftList;return(0,e.jsxs)("div",{className:"flex flex-col",children:[(0,e.jsxs)("div",{className:"battle-seat-bg h-[152px] md:h-[304px] seat-".concat(r+1," ").concat(q?"seat-last":""),children:[kt===0&&(0,e.jsx)(Ue,{onJoin:function(){E(r+1),ce(!0)},onJoinBot:function(){E(r+1),ge(!0)},user:a,userList:ae,isOwner:Ct}),me&&M&&(0,e.jsx)(Ze,{result:M}),Lt&&Ce&&(0,e.jsx)(X.Z,{giftList:ts,lotteryWin:Ce,randomPosition:!1,vertical:!0,onCompleted:Xt,boxSize:_e.md?{width:128,height:112}:{width:64,height:56},start:Mt,wrapHeight:_e.md?304:152,fast:!0,voice:Qe})]}),(0,e.jsx)("div",{className:"battle-user gap-1 sm:justify-between items-center flex-col md:flex-row text-sm p-3 md:p-4 min-h-[104px] md:min-h-[72px] ".concat(qt&&"win-user-bg"),children:a!=null&&a.customerId?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"flex flex-col md:flex-row gap-1 sm:gap-2 items-center",children:[(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("img",{src:a==null?void 0:a.headPic,className:"w-8 h-8 md:w-10 md:h-10 rounded-sm"}),(a==null?void 0:a.headGround)&&(0,e.jsx)("img",{src:a==null?void 0:a.headGround,className:"absolute left-0 top-0 w-full h-full"})]}),(0,e.jsx)("span",{className:"text-base-content text-opacity-50 truncate text-xs sm:text-base",children:a==null?void 0:a.nickname})]}),(0,e.jsxs)("div",{className:"flex gap-1 items-center text-xs sm:text-base",children:[(0,e.jsx)(p.B,{type:"icon-daimond"}),(0,e.jsx)(xe.ZP,{end:es||0,duration:1,decimals:2,separator:"",className:"font-num"})]})]}):(0,e.jsx)("div",{className:"w-full font-num uppercase h-full flex items-center justify-center text-center animate-pulse",children:"Waiting for player"})}),(0,e.jsx)("div",{className:"battle-result",children:(0,e.jsx)(ue,{boxs:(H==null?void 0:H.userOpenBoxRecord)||[],cols:s.countCustomer||2,mini:!_e.md})})]},r)})})}),(0,e.jsx)(ie.Z,{boxInfo:B,show:de,onClose:function(){fe(!1)}}),s&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(j.u_,{open:Ie,className:"confirm-modal-bg max-w-sm",children:[(0,e.jsx)(j.u_.Header,{className:"text-base mb-2",children:(0,e.jsx)(h.FormattedMessage,{id:"battle_room_join"})}),(0,e.jsxs)(j.u_.Body,{className:"text-sm",children:["\u9700\u6D88\u8017",(0,e.jsx)("span",{className:"text-primary mx-1",children:s==null?void 0:s.totalPrice}),"\u5F00\u542F\u5BF9\u6218,\u5171",(0,e.jsx)("span",{className:"mx-1 text-primary",children:s==null||(y=s.boxList)===null||y===void 0?void 0:y.length}),"\u56DE\u5408,\u786E\u5B9A\u8981\u53C2\u4E0E\u5417\uFF1F"]}),(0,e.jsxs)(j.u_.Actions,{children:[(0,e.jsx)(j.zx,{className:"btn-sm btn-outline rounded",onClick:function(){ce(!1)},children:(0,e.jsx)(h.FormattedMessage,{id:"cancel"})}),(0,e.jsx)(j.zx,{className:"btn-primary btn-sm rounded",onClick:function(){Ht(S)},loading:lt,children:(0,e.jsx)(h.FormattedMessage,{id:"confirm"})})]})]}),(0,e.jsxs)(j.u_,{open:Ke,className:"confirm-modal-bg max-w-sm",children:[(0,e.jsx)(j.u_.Header,{className:"text-base mb-2",children:"\u786E\u5B9A\u8981\u52A0\u5165\u673A\u5668\u4EBA\u5417\uFF1F"}),(0,e.jsx)(j.u_.Body,{className:"text-sm",children:"\u673A\u5668\u4EBA\u6982\u7387\u4E0E\u73A9\u5BB6\u5B8C\u5168\u76F8\u540C"}),(0,e.jsxs)(j.u_.Actions,{children:[(0,e.jsx)(j.zx,{className:"btn-sm btn-outline rounded",onClick:function(){ge(!1)},children:(0,e.jsx)(h.FormattedMessage,{id:"cancel"})}),(0,e.jsx)(j.zx,{className:"btn-primary btn-sm rounded",onClick:function(){Kt(S)},loading:ct,children:(0,e.jsx)(h.FormattedMessage,{id:"confirm"})})]})]}),(0,e.jsxs)(j.u_,{open:je,className:"confirm-modal-bg max-w-sm",children:[(0,e.jsx)(j.u_.Header,{className:"text-base mb-2",children:"\u786E\u5B9A\u8981\u89E3\u6563\u623F\u95F4\u5417\uFF1F"}),(0,e.jsx)(j.u_.Body,{className:"text-sm",children:"\u89E3\u6563\u540E\u623F\u95F4\u521B\u5EFA\u8D39\u7528\u5C06\u539F\u8DEF\u8FD4\u56DE\u5230\u60A8\u7684\u8D26\u6237\u4E2D"}),(0,e.jsxs)(j.u_.Actions,{children:[(0,e.jsx)(j.zx,{className:"btn-sm btn-outline rounded",onClick:function(){ne(!1)},children:(0,e.jsx)(h.FormattedMessage,{id:"cancel"})}),(0,e.jsx)(j.zx,{className:"btn-primary btn-sm rounded",onClick:function(){Yt()},loading:xt,children:(0,e.jsx)(h.FormattedMessage,{id:"confirm"})})]})]})]})]})}},15168:function(K,L,t){t.d(L,{p:function(){return Z},w:function(){return w}});var D=t(15009),f=t.n(D),Y=t(99289),R=t.n(Y),N=new Audio(t(58502)),o=new Audio(t(74121));function Z(){return O.apply(this,arguments)}function O(){return O=R()(f()().mark(function g(){return f()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.pause();case 2:return N.currentTime=0,e.next=5,N.play();case 5:case"end":return e.stop()}},g)})),O.apply(this,arguments)}function w(){o.play()}},7988:function(){},22372:function(){},58502:function(K,L,t){K.exports=t.p+"static/spin.b4686d11.mp3"},74121:function(K,L,t){K.exports=t.p+"static/win.ca3e5041.mp3"}}]);
